### Прогноз заказов такси
####  Цель проекта: Сокращение времени подачи и простоя такси.
####  Задача проекта: Требуется спрогнозировать количество заказов такси на следующий час в аэропорт, чтобы привлекать необходимое количество водителей в периоды пиковой нагрузки.

*Инструменты:* 
|  |  |
| :---         |     :---     |
|*python*|*sklearn.model_selection.TimeSeriesSplit*|
|*pandas*|*sklearn.metrics.mean_squared_error*|
|*numpy*|*sklearn.model_selection.GridSearchCV*|
|*statsmodels.tsa.seasonal.seasonal_decompose*|*sklearn.metrics.make_scorer*|
|*lightgbm.LGBMRegressor*|*sklearn.linear_model.LinearRegression*|
|*matplotlib*|*sklearn.ensemble.RandomForestRegressor*|
|*sklearn.dummy.DummyRegressor*|*sklearn.metrics.r2_score*|

#### Описание проекта

1. Проведено исследование временного ряда на предмет трендовых и сезонных закономерностей, случайной составляющей. Выяснили, что ряд имеет следующие характеристики:

   + Общий растущий тренд;
   + Недельная и суточная сезонность;
   + Случайная составляющая.

2. Сформированы следующие признаки для обучения модели:
 + номера наблюдения,
 + квадрат номера наблюдения, для учёта нелинейности тренда;
 + номер дня в месяце, для учёта внутримесячных сезонностей;
 + номер дня в неделе, для учёта внутринедельных сезонностей;
 + номер часа в сутках, для учёта внутридневных сезонностей;
 + лаги в диапазоне от 1 и 24 часов, для учёта внутридневной сезонности;
 + лаг в 7 * 24 часа, для учёта недельной сезонности;
 + скользящие средние с окном 12 часов.

3. Проверены четыре варианта моделей с кросс-валидацией.
Наилучшие результаты показала модель `LinearRegression`

| Модель | RMSE | r2_score |
| :---         |     :---:      |     :---:      |
| LinearRegression                   |       36.21     |      0.62        |
| DecisionTreeRegressor              |       47.70     |      0.34        |
| RandomForestRegressor              |       48.85     |      0.31        |
| LGBMRegressor                      |       39,28     |      0.56        |
| Константная модель 'DummyRegressor'|       84,45     |      -1.06       |


#### Вывод

Предлженная модель позволяет объяснить 62% дисперсии, удовлетворяет требование ТЗ по значению метрики RMSE (меньше 48 на тестовой выборке).
